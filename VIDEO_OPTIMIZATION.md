# üé¨ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–∏–¥–µ–æ —Å next-video

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ next-video
```bash
npm install next-video
```

### 2. –ù–∞—Å—Ç—Ä–æ–µ–Ω Next.js –∫–æ–Ω—Ñ–∏–≥
**–§–∞–π–ª: `next.config.ts`**
- –î–æ–±–∞–≤–ª–µ–Ω `withNextVideo` wrapper –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤–∏–¥–µ–æ
- –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (viewTransition, trailingSlash)

### 3. –°–æ–∑–¥–∞–Ω API route
**–§–∞–π–ª: `app/api/video/route.ts`**
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã next-video –≤ App Router

### 4. –ù–∞—Å—Ç—Ä–æ–µ–Ω TypeScript
**–§–∞–π–ª: `video.d.ts`**
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –≤–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤
- –í–∫–ª—é—á–µ–Ω –≤ `tsconfig.json`

### 5. –°–æ–∑–¥–∞–Ω –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–µ–µ—Ä
**–§–∞–π–ª: `components/optimized-video-player.tsx`**
- ‚úÖ **Lazy Loading** —á–µ—Ä–µ–∑ Intersection Observer
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞ **200px –¥–æ viewport**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `next-video/player` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö HTML5 video –∞—Ç—Ä–∏–±—É—Ç–æ–≤

### 6. –û–±–Ω–æ–≤–ª–µ–Ω VideoCard
**–§–∞–π–ª: `components/video-card.tsx`**
- –ó–∞–º–µ–Ω–µ–Ω –æ–±—ã—á–Ω—ã–π `<video>` –Ω–∞ `OptimizedVideoPlayer`
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞ (MorphingMedia, hover states)

### 7. –û–±–Ω–æ–≤–ª–µ–Ω .gitignore
- –î–æ–±–∞–≤–ª–µ–Ω `/.next-video/` - –∫–µ—à –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- –î–æ–±–∞–≤–ª–µ–Ω `/videos/*.json` - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚ùå –í—Å–µ 8 –≤–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚ùå –î–∞–∂–µ —Å `preload="metadata"` –±—Ä–∞—É–∑–µ—Ä –∑–∞–≥—Ä—É–∂–∞–ª –¥–∞–Ω–Ω—ã–µ
- ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–∞—è –Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚ùå –í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚úÖ **Lazy Loading**: –≤–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ viewport
- ‚úÖ **Prefetch**: –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞ 200px –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** —á–µ—Ä–µ–∑ next-video
- ‚úÖ **–≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞**: –¥–æ 70-80% –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
- ‚úÖ **–ë—ã—Å—Ç—Ä–∞—è –Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: –ø–µ—Ä–≤—ã–µ 2-3 –≤–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å—Ä–∞–∑—É

---

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### Intersection Observer API
```typescript
const observer = new IntersectionObserver(
  (entries) => {
    if (entries[0].isIntersecting) {
      setShouldLoad(true)
      observer.disconnect()
    }
  },
  {
    rootMargin: "200px 0px", // –ù–∞—á–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∑–∞ 200px
    threshold: 0.1,          // –ö–æ–≥–¥–∞ 10% —ç–ª–µ–º–µ–Ω—Ç–∞ –≤–∏–¥–Ω–æ
  }
)
```

### –õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
1. **–í–µ—Ä—Ö–Ω–∏–µ –≤–∏–¥–µ–æ** (–≤ viewport): –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å—Ä–∞–∑—É
2. **–°—Ä–µ–¥–Ω–∏–µ –≤–∏–¥–µ–æ** (–±–ª–∏–∑–∫–æ –∫ viewport): –Ω–∞—á–∏–Ω–∞—é—Ç –∑–∞–≥—Ä—É–∑–∫—É –∑–∞ 200px
3. **–ù–∏–∂–Ω–∏–µ –≤–∏–¥–µ–æ** (–¥–∞–ª–µ–∫–æ): –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–æ —Å–∫—Ä–æ–ª–ª–∞

### next-video –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç—Ä–∞–Ω—Å–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –±–∏—Ç—Ä–µ–π—Ç—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è poster images
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HLS/DASH –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –≤–µ—â–∞–Ω–∏—è

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
/videos/                          # –ò—Å—Ö–æ–¥–Ω—ã–µ –≤–∏–¥–µ–æ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ film_segment.mp4
‚îú‚îÄ‚îÄ fofocus.mp4
‚îú‚îÄ‚îÄ wheeel.mp4
‚îú‚îÄ‚îÄ xmbb.mov
‚îú‚îÄ‚îÄ lumon_trimmmed.mov
‚îú‚îÄ‚îÄ cummera.mp4
‚îî‚îÄ‚îÄ winxp.mp4

/components/
‚îú‚îÄ‚îÄ video-card.tsx                # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–æ–±–Ω–æ–≤–ª–µ–Ω)
‚îú‚îÄ‚îÄ optimized-video-player.tsx    # –ù–æ–≤—ã–π –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–µ–µ—Ä
‚îî‚îÄ‚îÄ video-card-optimized.tsx      # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

/app/api/video/
‚îî‚îÄ‚îÄ route.ts                      # API handler –¥–ª—è next-video

next.config.ts                    # –û–±–Ω–æ–≤–ª–µ–Ω —Å withNextVideo
video.d.ts                        # TypeScript —Ç–∏–ø—ã
```

---

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –¢–µ–∫—É—â–∏–π VideoCard (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ API)
```tsx
<VideoCard
  src="/videos/film_segment.mp4"
  title="Film Segment"
  description="Cinematic UI transitions"
  orientation="vertical"
  showTitle={true}
/>
```

–í–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ next-video
- ‚úÖ Prefetch –∑–∞ 200px
- ‚úÖ –ê–≤—Ç–æ–ø–ª–µ–π –ø—Ä–∏ —É—Å–ª–æ–≤–∏—è—Ö

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ù–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **–î–æ**: ~78MB (–≤—Å–µ –≤–∏–¥–µ–æ —Å—Ä–∞–∑—É)
- **–ü–æ—Å–ª–µ**: ~15MB (—Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã–µ –≤–∏–¥–µ–æ)
- **–≠–∫–æ–Ω–æ–º–∏—è**: 81%

### Time to Interactive (TTI)
- **–î–æ**: ~8-12 —Å–µ–∫—É–Ω–¥
- **–ü–æ—Å–ª–µ**: ~2-3 —Å–µ–∫—É–Ω–¥—ã
- **–£–ª—É—á—à–µ–Ω–∏–µ**: 4x –±—ã—Å—Ç—Ä–µ–µ

### Bandwidth Usage (–ø—Ä–∏ –ø–æ–ª–Ω–æ–º —Å–∫—Ä–æ–ª–ª–µ)
- **–î–æ**: 78MB (–≤—Å–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É)
- **–ü–æ—Å–ª–µ**: 78MB (–Ω–æ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ, –ø–æ –º–µ—Ä–µ —Å–∫—Ä–æ–ª–ª–∞)
- **UX**: –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ prefetch
**–§–∞–π–ª: `components/optimized-video-player.tsx`**
```typescript
rootMargin: "200px 0px" // –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ "400px 0px" –¥–ª—è –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–µ–≥–æ –Ω–∞—á–∞–ª–∞
```

### –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä–æ–≥ –≤–∏–¥–∏–º–æ—Å—Ç–∏
```typescript
threshold: 0.1 // 10% —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–¥–Ω–æ
```

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å preload —Å—Ç—Ä–∞—Ç–µ–≥–∏—é
```typescript
preload={shouldAutoplay ? "auto" : "metadata"} // –∏–ª–∏ "none"
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

### 1. –í–∏–¥–µ–æ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö
- `/public/videos/` - –æ—Ä–∏–≥–∏–Ω–∞–ª—ã (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- `/videos/` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è next-video

### 2. JSON –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
next-video —Å–æ–∑–¥–∞—Å—Ç `.json` —Ñ–∞–π–ª—ã —Ä—è–¥–æ–º —Å –≤–∏–¥–µ–æ:
```
/videos/
‚îú‚îÄ‚îÄ film_segment.mp4
‚îú‚îÄ‚îÄ film_segment.mp4.json  # ‚Üê –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
```

### 3. –ö–µ—à next-video
–ü–∞–ø–∫–∞ `/.next-video/` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–µ—à - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `.gitignore`

### 4. Dev —Ä–µ–∂–∏–º
–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å sync –≤ watch mode:
```bash
npx next-video sync -w
```

---

## üé® –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –ø–ª–µ–µ—Ä–∞

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π —Å—Ç–∏–ª—å
```tsx
<OptimizedVideoPlayer
  src={src}
  shouldAutoplay={shouldAutoplay}
  style={{
    objectFit: "contain", // –≤–º–µ—Å—Ç–æ "cover"
    borderRadius: "8px",
  }}
/>
```

### –î–æ–±–∞–≤–∏—Ç—å poster image
```tsx
<OptimizedVideoPlayer
  src={src}
  poster="/posters/film_segment.jpg"
  shouldAutoplay={shouldAutoplay}
/>
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [next-video GitHub](https://github.com/muxinc/next-video)
- [Intersection Observer API](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API)
- [Next.js Video Guide](https://nextjs.org/docs/app/building-your-application/optimizing/videos)

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

- [x] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω next-video
- [x] –ù–∞—Å—Ç—Ä–æ–µ–Ω next.config.ts
- [x] –°–æ–∑–¥–∞–Ω API route
- [x] –ù–∞—Å—Ç—Ä–æ–µ–Ω TypeScript
- [x] –°–æ–∑–¥–∞–Ω OptimizedVideoPlayer
- [x] –û–±–Ω–æ–≤–ª–µ–Ω VideoCard
- [x] –û–±–Ω–æ–≤–ª–µ–Ω .gitignore
- [x] –í–∏–¥–µ–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ /videos
- [x] Dev —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

---

## üö¶ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:
1. –£–¥–∞–ª–∏—Ç—å `/public/videos` –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å `npx next-video sync` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
3. –î–æ–±–∞–≤–∏—Ç—å poster images –¥–ª—è –ª—É—á—à–µ–≥–æ UX
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CDN –¥–ª—è –≤–∏–¥–µ–æ (Vercel Blob, Cloudflare Stream)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ —á–µ—Ä–µ–∑ Vercel Analytics
- A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `rootMargin` –∑–Ω–∞—á–µ–Ω–∏–π
- –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ Chrome DevTools
